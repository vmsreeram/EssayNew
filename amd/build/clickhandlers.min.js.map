{"version":3,"file":"clickhandlers.min.js","sources":["../src/clickhandlers.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * OnClick handlers are defined here\n * These functions will call functions in pdfannotate.js.\n *\n * @subpackage essayannotate\n * @copyright  2024 IIT Palakkad\n * @copyright  based on work done by Ravisha Hesh {@link https://github.com/RavishaHesh/PDFJsAnnotations/tree/master}\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\n// This function calls PDFAnnotate function defined in pdfannotate.js\n// fileurl has been assigned its correct value in annotator.php file\ndefine(['jquery', 'qtype_essayannotate/pdfannotate'], function($, PDFAnnotate) {\n    /**\n     * Changes the active tool based on the event target.\n     *\n     * @param {Event} event - The event object.\n     */\n    function changeActiveTool(event) {\n        event.preventDefault();\n        var element = $(event.target).hasClass(\"tool-button\")\n        ? $(event.target)\n        : $(event.target).parents(\".tool-button\").first();\n        $(\".tool-button.active\").removeClass(\"active\");\n        $(element).addClass(\"active\");\n    }\n\n    /**\n     * Enables the selector tool in the PDF.\n     *\n     * @param {Event} event - The event object.\n     * @param {PDFAnnotate} pdf - The PDFAnnotate instance.\n     */\n    function enableSelector(event, pdf) {\n        event.preventDefault();\n        changeActiveTool(event);\n        pdf.enableSelector();\n    }\n\n    /**\n     * Enables the pencil tool in the PDF.\n     *\n     * @param {Event} event - The event object.\n     * @param {PDFAnnotate} pdf - The PDFAnnotate instance.\n     */\n    function enablePencil(event, pdf) {\n        event.preventDefault();\n        changeActiveTool(event);\n        pdf.enablePencil();\n    }\n\n    /**\n     * Enables the add text tool in the PDF.\n     *\n     * @param {Event} event - The event object.\n     * @param {PDFAnnotate} pdf - The PDFAnnotate instance.\n     */\n    function enableAddText(event, pdf) {\n        event.preventDefault();\n        changeActiveTool(event);\n        pdf.enableAddText();\n    }\n\n    /**\n     * Enables the rectangle tool in the PDF.\n     *\n     * @param {Event} event - The event object.\n     * @param {PDFAnnotate} pdf - The PDFAnnotate instance.\n     */\n    function enableRectangle(event, pdf) {\n        event.preventDefault();\n        changeActiveTool(event);\n        pdf.enableRectangle();\n    }\n\n    /**\n     * Deletes the selected object in the PDF.\n     *\n     * @param {Event} event - The event object.\n     * @param {PDFAnnotate} pdf - The PDFAnnotate instance.\n     */\n    function deleteSelectedObject(event, pdf) {\n        event.preventDefault();\n        pdf.deleteSelectedObject();\n    }\n\n    /**\n     * Saves the PDF.\n     *\n     * @param {Event} event - The event object.\n     * @param {PDFAnnotate} pdf - The PDFAnnotate instance.\n     */\n    function savePDF(event, pdf) {\n        event.preventDefault();\n        pdf.savePdf(); // Changes made by Asha and Parvathy: Removed a parameter of the function\n    }\n\n    //Change the color and font size to currently selected color and font size respectively in the UI\n\n    return {\n        init: function(fileurl) {\n            // eslint-disable-next-line no-console\n            window.console.log(\"ClickHandler :: Init\");\n\n            window.alert(\"sometext clickhandler\");\n            window.console.log(PDFAnnotate);\n            var pdf = new PDFAnnotate.PDFAnnotate(\"pdf-container\", fileurl, {\n                onPageUpdated: function(page, oldData, newData) {}, // eslint-disable-line no-unused-vars\n                ready: function() {},\n                scale: 1.5,\n                pageImageCompression: \"SLOW\", // FAST, MEDIUM, SLOW(Helps to control the new PDF file size)\n            });\n            $(function () {\n                $('.color-tool').click(function () {\n                    $('.color-tool.active').removeClass('active');\n                    $(this).addClass('active');\n                    var color = $(this).get(0).style.backgroundColor;\n                    pdf.setColor(color);\n                });\n\n                $('#font-size').change(function () {\n                    var font_size = $(this).val();\n                    pdf.setFontSize(font_size);\n                });\n            });\n\n            const pencilButton = document.getElementById('pencil');\n            pencilButton.addEventListener('click', function(event) {\n                enablePencil(event, pdf);\n            });\n            const selectorButton = document.getElementById('select');\n            selectorButton.addEventListener('click', function(event) {\n                enableSelector(event, pdf);\n            });\n            const addTextButton = document.getElementById('text');\n            addTextButton.addEventListener('click', function(event) {\n                enableAddText(event, pdf);\n            });\n            const rectangleButton = document.getElementById('rectangle');\n            rectangleButton.addEventListener('click', function(event) {\n                enableRectangle(event, pdf);\n            });\n            const deleteButton = document.getElementById('deletebtn');\n            deleteButton.addEventListener('click', function(event) {\n                deleteSelectedObject(event, pdf);\n            });\n            const saveButton = document.getElementById('savebtn');\n            saveButton.addEventListener('click', function(event) {\n                savePDF(event, pdf);\n            });\n        }\n    };\n});\n"],"names":["define","$","PDFAnnotate","changeActiveTool","event","preventDefault","element","target","hasClass","parents","first","removeClass","addClass","init","fileurl","window","console","log","alert","pdf","onPageUpdated","page","oldData","newData","ready","scale","pageImageCompression","click","this","color","get","style","backgroundColor","setColor","change","font_size","val","setFontSize","document","getElementById","addEventListener","enablePencil","enableSelector","enableAddText","enableRectangle","deleteSelectedObject","savePdf","savePDF"],"mappings":";;;;;;;;;AA4BAA,2CAAO,CAAC,SAAU,oCAAoC,SAASC,EAAGC,sBAMrDC,iBAAiBC,OACtBA,MAAMC,qBACFC,QAAUL,EAAEG,MAAMG,QAAQC,SAAS,eACrCP,EAAEG,MAAMG,QACRN,EAAEG,MAAMG,QAAQE,QAAQ,gBAAgBC,QAC1CT,EAAE,uBAAuBU,YAAY,UACrCV,EAAEK,SAASM,SAAS,gBA2EjB,CACHC,KAAM,SAASC,SAEXC,OAAOC,QAAQC,IAAI,wBAEnBF,OAAOG,MAAM,yBACbH,OAAOC,QAAQC,IAAIf,iBACfiB,IAAM,IAAIjB,YAAYA,YAAY,gBAAiBY,QAAS,CAC5DM,cAAe,SAASC,KAAMC,QAASC,WACvCC,MAAO,aACPC,MAAO,IACPC,qBAAsB,SAE1BzB,GAAE,WACEA,EAAE,eAAe0B,OAAM,WACnB1B,EAAE,sBAAsBU,YAAY,UACpCV,EAAE2B,MAAMhB,SAAS,cACbiB,MAAQ5B,EAAE2B,MAAME,IAAI,GAAGC,MAAMC,gBACjCb,IAAIc,SAASJ,UAGjB5B,EAAE,cAAciC,QAAO,eACfC,UAAYlC,EAAE2B,MAAMQ,MACxBjB,IAAIkB,YAAYF,iBAIHG,SAASC,eAAe,UAChCC,iBAAiB,SAAS,SAASpC,iBAlFlCA,MAAOe,KACzBf,MAAMC,iBACNF,iBAAiBC,OACjBe,IAAIsB,eAgFIA,CAAarC,MAAOe,QAEDmB,SAASC,eAAe,UAChCC,iBAAiB,SAAS,SAASpC,iBAlGlCA,MAAOe,KAC3Bf,MAAMC,iBACNF,iBAAiBC,OACjBe,IAAIuB,iBAgGIA,CAAetC,MAAOe,QAEJmB,SAASC,eAAe,QAChCC,iBAAiB,SAAS,SAASpC,iBA9ElCA,MAAOe,KAC1Bf,MAAMC,iBACNF,iBAAiBC,OACjBe,IAAIwB,gBA4EIA,CAAcvC,MAAOe,QAEDmB,SAASC,eAAe,aAChCC,iBAAiB,SAAS,SAASpC,iBAtElCA,MAAOe,KAC5Bf,MAAMC,iBACNF,iBAAiBC,OACjBe,IAAIyB,kBAoEIA,CAAgBxC,MAAOe,QAENmB,SAASC,eAAe,aAChCC,iBAAiB,SAAS,SAASpC,iBA9D1BA,MAAOe,KACjCf,MAAMC,iBACNc,IAAI0B,uBA6DIA,CAAqBzC,MAAOe,QAEbmB,SAASC,eAAe,WAChCC,iBAAiB,SAAS,SAASpC,iBAvDrCA,MAAOe,KACpBf,MAAMC,iBACNc,IAAI2B,UAsDIC,CAAQ3C,MAAOe"}